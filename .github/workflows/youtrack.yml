name: YouTrack to GitHub Issues Sync

on:
  schedule:
    # Run every 15 minutes
    - cron: '*/15 * * * *'
  workflow_dispatch: # Allow manual trigger
  push:
   branches:
   - 'shanice/you_track'

env:
  YOUTRACK_BASE_URL: ${{ secrets.YOUTRACK_BASE_URL }}
  YOUTRACK_TOKEN: ${{ secrets.YOUTRACK_TOKEN }}
  YOUTRACK_GITHUB_TOKEN: ${{ secrets.YOUTRACK_GITHUB_TOKEN }}
  PROJECT_ID: ${{ secrets.YOUTRACK_PROJECT_ID }}
  GITHUB_REPO: 'CDCgov/dibbs-vm'

jobs:
  sync-issues:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Install dependencies
        run: |
          pip install requests python-dotenv


      - name: Sync YouTrack to GitHub
        run: python send_YT_to_Github.py
        env:
          YOUTRACK_BASE_URL: ${{ env.YOUTRACK_BASE_URL }}
          YOUTRACK_TOKEN: ${{ env.YOUTRACK_TOKEN }}
          YOUTRACK_GITHUB_TOKEN: ${{ env.YOUTRACK_GITHUB_TOKEN }}
          PROJECT_ID: ${{ env.PROJECT_ID }}
          GITHUB_REPO: ${{ github.repository }}
          